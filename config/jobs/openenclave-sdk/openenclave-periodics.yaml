periodics:
- name: periodic-openenclave-openenclave-sdk-1604-dry
  decorate: true 
  interval: 12h
  decorate: false
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1604-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make"

- name: periodic-openenclave-openenclave-sdk-1604-full
  decorate: true 
  interval: 12h
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1604-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make && \
      OE_SIMULATION=1 ctest"

- name: periodic-openenclave-openenclave-sdk-1804-dry
  decorate: true 
  interval: 12h
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1804-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make"

- name: periodic-openenclave-openenclave-sdk-1804-full
  decorate: true 
  interval: 12h
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1804-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make && \
      OE_SIMULATION=1 ctest"

- name: periodic-openenclave-openenclave-1604-sdk-sgx-1
  decorate: true 
  interval: 12h
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1604-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make && \
      ctest"
      securityContext:
        privileged: true
    volumes:
    - name: dev-sgx
      hostPath:
        path: /dev/sgx
    restartPolicy: Never

- name: periodic-openenclave-openenclave-1804-sdk-sgx-1
  decorate: true 
  interval: 12h
  spec:
    containers:
    - image: brmclare/oesdk-ubuntu1804-dev:latest
      command:
      - sh
      - "-c"
      # Hack, need to get Docker file in oeeger8r repo
      - "git clone --recursive https://github.com/openenclave/openenclave && cd openenclave && \
      mkdir build && \
      cd build && \
      cmake .. && \
      make && \
      ctest"
      volumeMounts:
      - mountPath: /dev/sgx
        name: dev-sgx
      securityContext:
        privileged: true
    volumes:
    - name: dev-sgx
      hostPath:
        path: /dev/sgx